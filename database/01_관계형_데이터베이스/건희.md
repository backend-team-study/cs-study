# 01 관계형 데이터베이스

## 🟩데이터베이스와 파일 시스템의 차이

## 🟦파일 시스템

파일 시스템은 파일(데이터의 모임)으 저장 장치에 저장하고 사용하기 위한 일종의 규칙이나 체계를 뜻하며, 파일의 이름을 붙이고, 쉽게 파일에 접근할 수 있도록 배치를 신경 쓰는 등 파일과 관련된 기능을 수행하는 시스템이다.

파일의 기본적인 구성요소는 **순차적인 레코드**들이며, 레코드는 파일을 다룰 때 실제로 읽고 쓰는 단위로서 사용되는 데이터 단위를 뜻한다. 데이터 시스템 등장 이전부터 사용돼 왔다.

파일 시스템에서는 파일에 접근하는 방식이 응용 프로그램 내에 표현되므로 응용 프로그램과 데이터 간의 **의존관계가 존재**하게 되어 데이터의 구조, 접근 방법이 변경되면 기존의 프로그램과 데이터를 함께 변경해야만 한다.

즉, 데이터 정의가 응용 프로그램에 내포되어 있다는 의미이다. 또, 프로그램에서 데이터를 접근하고 조작하는 것 이외에 별도의 제어가 없다.



### 파일 시스템 단점

- 데이터의 **`종속성`**

  **각 응용프로그램마다 독자적인 파일이 있으니 생기는 문제점**으로 데이터를 사용하는 프로그램의 구조가 데이터 구조(파일)의 영향을 받으므로 응용 프로그램을 변경시키려면 파일을 변경해야 하고, 파일을 변경시키려면 응용프로그램도 같이 변경해야 한다.

  → 이러한 변경의 전파는 유지보수를 어렵게 하고 비용도 많이 들게 한다.

- 데이터 간 `불일치`가 발생할 수 있다

  중복된 데이터의 변경을 제어하는 것이 어렵기 때문에 여러 개의 중복 데이터 중 일부의 데이터만 변경된다고 하면 기존 데이터와의 불일치가 발생할 수 있다

- 다수 사용자를 위한 동시성 제어가 제공되지 않는다

  두 사용자가 동시에 파일에 접근할 때 각 사용자가 혼자서 데이터베이스를 접근하는 것처럼 인식하도록 하는 동기화가 되지 않는다. (작업 단위를 구분하는 트랜잭션도 없기 때문에 더더욱 그렇다)

- 쉬운 질의어가 제공되지 않는다

  SQL 같은 질의어가 없다.

- 보안 기능이 미흡하다

  파일 시스템에서는 파일 단위로만 검색, 갱신, 실행 권한을 부여할 수 있기 때문에 사용자의 권한에 따른 세밀한 접근 제어를 시행하기 어렵다

- 회복 기능이 없다

  응용 프로그램에서 파일 내의 데이터를 수정하는 도중에 강제로 파일이 닫히는 등의 사고가 발생했을 때 데이터를 복구하는 기능이 없다.

- 데이터 모델링 개념이 부족하다

  단순히 순차적인 레코드만으로 나타내기 때문에 데이터의 의미와 데이터 간의 상호 관계를 나타내기 힘들다.

- 데이터 `무결성`을 유지하기 어렵다

  파일 내의 데이터가 만족시켜야 하는 무결성 제약조건을 명시하려면 프로그래머가 직접 프로그래밍 언어를 사용하여 일일이 프로그램에 표현해야 하므로 데이터 무결성을 유지하기가 어렵다. 또한 새로운 제약조건들을 추가하거나 기존의 제약조건을 수정하는 것도 어렵다

  ```java
  if (value < 0) error; // 이런 제약 조건을 일일이 프로그래머가 해줘야 한다는 것
  ```

- 생산성이 낮다

  각 응용 프로그램마다 프로그래머가 새로운 파일 형식과 설명을 설계하는 과정부터 시작한 후 새로운 응용 프로그램을 위한 파일 접근 논리를 작성해야 하기 때문에 개발 시간이 오래 걸린다.

- 데이터 공유가 잘 되지 않는다.

  각 응용 프로그램마다 파일들을 갖고 있으며 데이터를 접근하는 응용 프로그램들이 여러 가지 프로그래밍 언어들로 작성되어 데이터 공유가 제한된다.

## 🟦데이터베이스 시스템

DBMS (Data Base Management System) 이란 데이터 베이스 내의 데이터를 다수의 사용자들이 접근할 수 있도록 해주는 소프트웨어들을 의미한다. 기존의 파일 시스템을 기반으로 데이터를 관리했을 때는 데이터의 중복, 불일치 등의 문제가 많았는데 이러한 단점을 보완하기 위해 데이터베이스가 생겨났다. DBMS 는 다음과 같은 특징을 지닌다.

1. 데이터의 독립성 (파일 시스템은 데이터와 응용 프로그램이 상호 의존 관계)

   데이터 베이스 사이즈를 늘리거나 성능 향상을 위해 데이터 파일을 늘리거나 새롭게 추가하더라도 관련된 응용 프로그램을 수정할 필요가 없다.

2. 데이터의 무결성

   여러 경로를 통해 잘못된 데이터가 발생하는 상황을 방지하는 기능으로 데이터의 유효성 검사를 통해 데이터의 무결성을 구현하게 된다. (파일 시스템은 응용 프로그램 별로 제약 조건을 일일이 처리해줘야 하기 때문에 어려움)

3. 데이터의 보안성

   허가된 사용자들만 데이터베이스나 데이터베이스 내의 자원에 접근할 수 있도록 계정 관리 또는 접근 권한을 설정

4. 데이터의 일관성

   연관된 정보를 논리적인 구조로 관리함으로써 데이터의 수정이 불일치를 발생시키는 상황들을 배제할 수 있다.

5. 데이터의 중복 최소화

   데이터 베이스는 데이터를 통합해서 관리함으로써 데이터 중복 문제를 해결할 수 있다.

### DBMS의 단점

여러 장점에도 불구하고 역시 DMBS도 만능은 아니다.

- 비용

  파일시스템보다 더 많은 것을 제공하기 때문에 당연하게도 하드웨어 자원을 많이 필요로 한다. 뿐만 아니라 DBMS 자체가 가격이 비싸고 이를 전문적으로 다루는 인력도 필요하기 때문에 인건비도 무시할 수 없다.

- 복잡성

  백업과 회복의 기능을 제공하지만 복잡성을 증대시킨다.

- 고장

  DBMS는 통합적인 시스템이기 때문에 일부의 고장이 전체 시스템의 고장으로 전파될 수 있다.

|                    | 파일시스템                                                   | 데이터베이스                                                 |
| ------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 구조               | 특정한 구조가 존재 X (raw data)                              | table 형태로 저장                                            |
| 접근 방식          | 순차적 접근만 가능                                           | 비순차적 접근도 가능                                         |
| 중복               | O                                                            | 비교적 덜 발생                                               |
| 불일치             | O                                                            | 비교적 덜 존재                                               |
| 트랜잭션           | X                                                            | 존재                                                         |
| 다중 사용자의 접속 | 파일 시스템에서는 사용자가 동시 에 접속 했을때 문제가 발생할 여지가 있음. | 동시에 접속했을 떄 사용자를 구분하고, 우선순위를 부여 해서 작업을 수행하도록 할 수 있음 |
| 보안 및 권리       | 각 프로그램마다 데이터를 가지고 있기 때문에 보안이 까다로움. | 사용자들마다 다른 권한 부여 가능                             |
| 질의어             | X                                                            | SQL                                                          |
| 회복               | X                                                            | O                                                            |
| 구현               | 간단                                                         | 복잡                                                         |
| 비용               | 저렴                                                         | 비쌈                                                         |

## 관계형 데이터베이스의 개념과 장단점

## 🟦개념

관계형 데이터 베이스는 데이터를 `테이블`형태로 관리하는 데이터베이스 모델입니다.

테이블은 `행과 열`로 이루어져 있으며, 행은 하나의 레코드 (데이터의 단위)를 나타내고 열은 레코드의 속성 (데이터의 종류)을 나타냅니다.

이러한 테이블은 관계(relationship)로 이루어져 있으며, 관계는 테이블 간에 서로 연결된 구조를 가지고 있습니다.

## 🟦종류

대표적으로는 MySQL, Oracle, PostgreSQL, SQL server 등이 있으며, 이들은 각각의 장단점과 특징을 지니고 있습니다. 또한, NoSQL 데이터베이스도 등장하면서 관계형 데이터베이스와 함께 사용되는 경우도 많습니다.

## 🟦장단점

장점으로는 데이터의 `일관성과 무결성`을 보장할 수 있으며, 표준화된 SQL (Structured Query Language)을 사용하기 때문에 다른 데이터베이스 모델에 비해 학습이 쉽고, 데이터를 처리하는 속도가 빠릅니다. 또한, 테이블 간의 관계를 설정하여 데이터의 중복을 제거할 수 있습니다.

단점으로는 `대용량 데이터 처리에 한계`가 있고, `복잡한 데이터 구조를 처리하기에는 어렵`습니다. 또한, 테이블 간의 `관계가 복잡해질수록 성능이 저하`될 가능성이 있습니다.

- 시스템이 커지면 Join을 많이 걸기 때문에 성능 저하
- 스키마로 인해 데이터가 유연하지 못함. 나중에 스키마가 변경하기 번거로움

> **비정형 데이터를 처리하기 힘들다 → 비정형 데이터란?**
>
> 비정형 데이터는 고정된 `구성 원칙이 없는 필터링되지 않은 정보`를 말합니다. 흔히 원시 데이터라고도 불립니다. 일반적인 예로는 웹 로그, XML, JSON, 텍스트 문서, 이미지, 비디오 및 오디오 파일이 있습니다.

## 🟩DDL, DML, DCL, TCL

## 🟦DDL (Data Defintion Language)

DDL은 데이터를 정의하는 언어를 의미하며, 데이터베이스에서 스키마를 정의하거나 조작하기 위해서 사용하는 명령어들을 의미합니다. → **데이터 베이스의 전체 골격을 구성하는 역할**

- CREATE - 테이블 생성 및 정의
- ALTER - 테이블 구조 변경
- DROP - 테이블 및 칼럼 삭제
- TRUNCATE - 데이터 삭제

## 🟦DML (Data Manipulation Language)

DML은 데이터를 조작하는 언어를 뜻하며, 데이터베이스에서 데이터를 조작하기 위해 사용되는 명령어들을 의미합니다. → **데이터 베이스 내부에 실제로 저장된 데이터들을 다루는 역할**

- SELECT - 조회
- INSERT - 추가
- UPDATE - 변경
- DELETE - 삭제

## 🟦DCL (Data Control Language)

DCL은 데이터 베이스에 대한 접근 권한 제어에 사용하는 언어로 각종 권한을 부여 및 회수합니다.

**→ 권한 관리를 통해 시스템 보안을 유지하는 역할**

- GRANT - 특정 작업에 대한 권한 부여
- REVOKE - 권한 박탈 및 회수

## 🟦TCL (Transaction Control Language)

TCL은 DCL과 유사하지만, data를 제어하는 것이 아닌 트랜잭션을 제어하기 위해 사용합니다.

여기서 트랜잭션이란 DB를 조작하는 논리적 연산 단위를 의미합니다. **TCL 개념을 사용하지 않고 DCL로 분류하는 경우도 있습니다.**

예를 들어 게시판에 글을 작성하는 작업의 경우, 게시판에 글을 업로드 하기 위해서는 게시글을 작성(insert) 및 작성된 게시글을 게시판에서 조회(select) 등의 작업을 수행해야 하고, 이렇게 select + insert 문의 수행을 합쳐 트랜잭션이라는 하나의 작업 단위로 부릅니다.

- COMMIT - 올바르게 반영된 데이터를 db에 반영
- ROLLBACK - COMMIT 되지 않은 모든 트랜잭션을 수행 이전으로 되돌림
- SAVEPOINT - 저장점을 지정, 이후 ROLLBACK과 함께 사용하여 특정 지점까지 ROLLBACK이 가능

### 🟨트랜잭션의 특징

1. 원자성 (Atomicity) : 트랜잭션에 정의된 연산들은 모두 성공적으로 실행되거나 전혀 실행되지 않아야 한다.
2. 일관성 (Consistency) : 트랜잭션 실행 전 DB의 내용이 잘못되지 않으면, 실행 후에도 잘못되지 않아야 한다.
3. 고립성 (Isolation) : 트랜잭션 실행 도중에는 다른 트랜잭션의 영향을 받으면 안된다.
4. 지속성 (Durability) : 트랜잭션이 성공적으로 수행되면, DB의 내용은 영구적으로 저장된다.

## 🟩Key

Key의 종류

- 슈퍼키 (Super Key) : `유일성`을 만족하는 키. ex) {학번 + 이름}, {주민번호 + 학번}
- 복합키 (Composite Key) : `2개 이상`의 속성을 사용한 키
- 후보키 (Candidate Key) : `유일성`과 `최소성`을 만족하는 키. 기본키가 될 수 있는 후보이기 때문에 후보키라고 불린다. ex) 주민등록번호, 학번 등
- 기본키 (Primary Key) : 후보키에서 선택된 키. `Null` 값이 들어갈 수 없으며, 기본키로 선택된 속성은 동일한 값이 들어갈 수가 없다.
- 대체키 (Surrogate Key) : 후보키 중에 기본키로 선택되지 않은 키
- 외래키 (Foreign Key) : 어떤 테이블 간의 기본키를 참조하는 속성. 테이블들 간의 관계를 나타내기 위해서 사용된다.

![image-20231023211453761](C:\Users\WEON\AppData\Roaming\Typora\typora-user-images\image-20231023211453761.png)

https://inpa.tistory.com/entry/DB-📚-키KEY-종류-🕵️-정리

## 🟦슈퍼키 (유일성을 만족하는 키)

- 7조라는 팀에 팀원은 4명이 있다. 이 4명을 구분할 수 있는 것은 절대 겹치지 않는 학번 일수도 있고, 주민번호일 수도 있다.
- 이름과 나이를 묶어서 하나의 속성으로 만드는 것도 가능하다. 이름과 나이를 합쳐서 7조안에서 중복만 되지 않으면 가능하기 때문이다. 이름과 나이를 합쳐서 4명을 구분할 수 있으면 `슈퍼키가 될 수 있다.`
- 학번과 주민번호를 묶어서 슈퍼키로 만들수도 있고, 학번과 주민번호과 이름을 합쳐서 슈퍼키로도 만들수 있고, 학번과 주민번호과 이름과 나이를 합쳐서 슈퍼키를 만들수도 있다. **어떤 속성끼리 묶던 중복값이 안나오고 서로 구별**만 할 수 있으면 된다.

![image-20231023211518159](C:\Users\WEON\AppData\Roaming\Typora\typora-user-images\image-20231023211518159.png)

## 🟦후보키 (유일성과 최소성을 만족하는 키)

- 위에서 말했듯이, 이 4명을 구분하는 슈퍼키들이 모여 있는데, **슈퍼키들 중에서 최소한의 속성 갯수**로 4명을 **구분할 수 있어야 후보키가 될 수 있다.**
- 학번 슈퍼키와 주민번호 슈퍼키는 속성들이 각 1개씩 이루어져 있다. 하지만 이름+나이 슈퍼키는 이름과 나이를 묶어서 2개의 속성으로 되어 있다. 이름+나이 슈퍼키는 2개 이므로 각 1개의 속성인 주민번호와 학번 슈퍼키가 최소성을 만족한다고 할 수 있다.
- 따라서 이름 + 나이 슈퍼키는 갯수가 다른 것보다 많기 때문에 **최소성을 만족하지 못해 후보키가 될 수 없다.**

![image-20231023211526411](C:\Users\WEON\AppData\Roaming\Typora\typora-user-images\image-20231023211526411.png)



## 🟦기본키 (후보키에서 선택된 키)

- 후보키들 중에서 하나를 선택한 키로 최소성과 유일성을 만족하는 속성이다.
- 테이블에서 기본키는 **오직 1개만** 지정할 수 있다.
- 기본키는 Null 값을 절대 가질 수 없고, 중복된 값을 가질 수 없다.

## 🟦대체키 (후보키에서 선택되지 않은 키)

- 후보키가 두개 이상일 경우 기본키로 지정하고 남은 후보키들을 칭함
- 선택된 후보키 (기본키) 가 사라지는 경우 대체할 수 있다.

## 🟦외래키

- 참조 될 테이블 (A) 이 먼저 만들어지고 참조하는 테이블 (B) 에 값이 입력되어야 한다. (순서가 중요)
- 이때, 참조될 열의 값(키)은 기본키로 설정되어 있어야 한다.
- 외래키는 참조되는 테이블의 기본키와 동일한 키 속성을 가진다.
- 참조 대상인 부모 테이블 먼저 삭제될 수 없다. 왜냐하면 부모 테이블을 참조하는데, 부모테이블이 삭제되면 자식테이블은 참조하는 것이 없어지기 때문에 외래키 제약 조건에 걸린다. 따라서 외래키 관계에서 부모 테이블을 삭제하려면 자식테이블을 먼저 삭제한 후 부모 테이블을 삭제해야 한다.

# 결론

데이터 처리의 목적과 특성에 따라 적합한 데이터 베이스 모델을 선택하는 것이 중요하다.